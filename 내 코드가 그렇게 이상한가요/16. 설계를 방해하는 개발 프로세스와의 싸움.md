
## 커뮤니케이션

#### 1) 커뮤니케이션이 부족하면 설계 품질에 문제가 발생

팀 개발에서는 팀원과 어떤 코드를 작업할 때, 서로의 로직이 제대로 맞물리지 않아 버그로 이어지는 상황이 매우 흔합니다. 이런 현상이 일어나는 이유는 팀원 간의 커뮤니케이션이 부족하기 때문입니다.

#### 2) 콘웨이 법칙

커뮤니케이션 문제 해결과 관련된 콘웨이 법칙을 소개하겠습니다. <span style="color:#ff0000">콘웨이 법칙</span>은 '시스템의 구조는 그것을 설계하는 조직의 구조를 닮아 간다'라는 법칙입니다. 조금 더 알기 쉽게 예를 들면, 개발 부문이 3개의 팀으로 구분되어 있다면 모듈의 수도 팀의 수와 동일하게 3개로 구성되는 시스템이 만들어진다는 것입니다.

콘웨이 법칙은 커뮤니케이션 비용 구조의 법칙이라고도 말할 수 있습니다. 팀 내부에서 이뤄지는 커뮤니케이션은 비용이 낮고, 팀 외부와의 커뮤니케이션은 비용이 높다는 비용 구조 자체가 시스템 구조에 영향을 준다는 것입니다. 따라서 만들어야 하는 시스템의 구조와 조직 구조에 차이가 있다면, 시스템 구조를 제대로 잡기 어려워집니다.

그래서 최근에는 콘웨이 법칙을 반대로 접근하는 역콘웨이 법칙이라는 것이 등장했습니다. 이는 '소프트웨어의 구조를 먼저 설계하고, 이후 소프트웨어의 구조에 맞게 조직을 편성한다'는 접근 방법입니다.

콘웨이 법칙은 커뮤니케이션 비용 구조의 법칙입니다. 다시 말해, 팀원 간 커뮤니케이션 문제는 팀원 간 커뮤니케이션 비용이 높다는 이야기입니다.

#### 3) 심리적 안정성

팀원 간 관계 개선에는 심리적 안정성이 중요합니다. 심리적 안정성이란 '어떤 발언을 했을 때, 부끄럽거나 거절당하지 않을 것이라는 확신을 느낄 수 있는 심리 상태', '안심하고 자유롭게 발언 또는 행동할 수 있는 상태' 등으로 정의합니다. 심리적 안정성은 성공적인 팀을 구축할 때 매우 중요한 개념이라고 알려져 있습니다. 커뮤니케이션에 문제가 있을 때는 일단 심리적 안정성 향상에 힘쓰는 것이 좋습니다.


---

## 설계

설계는 굉장히 중요한 개발 프로세스입니다. 그런데 설계가 제대로 이루어지지 못하게 하거나, 설계한 것이 제대로 동작하지 않게 하는 다양한 함정이 있습니다. 각각의 함정과 대처 방법을 살펴봅시다.

#### 1) '빨리 끝내고 싶다'는 심리가 품질 저하의 함정

품질이 나쁜 시스템을 만드는 팀은 클래스 설계와 관련된 습관이 애초에 없는 경우가 많습니다. 이는 납기 일정이 엄격한 외주 개발에서 흔한 광경입니다. 이러한 환경에서는 클래스 다이어그램조차 그려보지 않는 등 설계 품질을 무시하기 쉽습니다. 품질을 무시하고 구현하는 과정이 반복되면, 조악한 코드는 점점 더 조악해집니다.

#### 2) 나쁜 코드를 작성하는 것이 좋은 코드를 작성하는 것보다 오래 걸린다.

클린 아키텍처 책에서는 테스트 주도 개발을 사요해서 구현하는 경우와 사용하지 않고 구현하는 경우 중 어느 쪽이 더 빨리 개발을 완료하는지에 관한 비교 실험에 대한 글이 있습니다. TDD는 프로덕션 코드 이외에도 테스트 코드를 추가로 구현해야 하므로, 언뜻 더 느릴 것처럼 보입니다.

하지만 이 실험에서는 TDD를 사용하는 편이 전체적으로 보았을 때 더 빠르다는 결론이 나온 것입니다. 이런 결과를 보더라도, 저자는 '일단 어떻게든 움직이는 코드를 빨리 작성하는 것이 좋다' 라는 생각에 동의하지 않고 있습니다.

#### 3) 클래스 설계와 구현 피드백 사이클 돌리기

사양을 변경할 때는 최소한 메모로라도 클래스 다이어그램을 그려 보세요. 이를 기반으로 책무와 응집도 등의 관점에서 문제가 없는지, 팀과 함께 간단하게 리뷰해 보세요. 문제가 없어 보인다면, 구현하기 시작합니다.

사실 구현하다 보면 예상하지 못했던 요소들을 발견하게 될 것입니다. 이때마다 클래스 다이어그램에 반영해 보기 바랍니다. 이와 같은 설계와 구현 피드백 사이클을 돌리다 보면, 설계 품질이 향상될 것입니다.

#### 4) 한 번에 완벽하게 설계하려고 들지 말고, 사이클을 돌리며 완성하기

사양을 대규모로 변경할 때는 그만큼 확실한 클래스 설계가 필요합니다. 하지만 한 번에 완벽하게 설계하려는 욕심은 버리기를 권장합니다. 설계를 완벽하게 했다고 생각해도, 구현하다 보면 결국 동작에 필요한 요소들을 추가로 발견하게 될 것입니다.

> 단 한 번의 설계로 완벽한 구조를 만들어 낼 수는 없습니다.

설계 품질은 설계와 구현 피드백 사이클을 계속해서 돌리면, 조금씩 향상되는 것입니다. '설계와 구현은 다른 문제다', '이런 설계로 가기로 했는데 왜 계속 바뀌냐?' 라는 등의 이야기가 나오면 팀원들이 분열될 수도 있으므로 피드백 사이클을 돌며 개발할 때는 개발 방식에 대해 처음부터 확실하게 합의하고 시작하는 것이 좋습니다.

#### 5) '성능이 떨어질 수 있으니 클래스를 작게 나누지 말자'는 맞는 말일까?

클래스가 많아지면 비용이 발생하는 것은 맞습니다. 하지만 대부분의 상황에는 무시할 수 있는 정도입니다. 병목이 어디인지 모른 채 성능이 빠른 코드를 작성하려고만 하는 것은 너무 빠른 최적화라고 하는 안티패턴에 해당합니다.

#### 6) 설계 규칙을 다수결로 결정하면 코드 품질은 떨어진다.

코드 품질을 향상시키기 위해 코딩 규칙과 설계 규칙을 정하는 경우가 있습니다. 그런데 이때 팀 전체의 합의를 이루고자, 규칙을 다수결로 결정하는 경우가 있습니다.

하지만 설계 규칙을 만들 때 다수결을 따르면, 일반적으로 결과가 좋지 않습니다.

#### 7) 설계 규칙을 정할 때 중요한 점

팀원들의 능력 차이가 큰 경우에는 다수결보다, 시니어 엔지니어처럼 설계 역량이 뛰어난 팀원이 중심이 되어 규칙을 만드는 것이 좋습니다. 그리고 팀 리더의 권한으로 규칙을 지킬 수 있게 추진해 나가면 됩니다.

각각의 설계 규칙에는 이유와 의도를 함께 적는 것이 좋습니다. 규칙이 형식만 강제하고, 아무런 의미를 갖지 않는 상황을 막기 위해서입니다. 예를 들어 아래 표처럼 작성합니다

| 규칙                                                                                                  | 이유와 의도                                   |
| ------------------------------------------------------------ | ---------------------------------------- |
| 중첩을 3번 이하로 해야 한다. 중첩의 깊이기 깊어질 경우, 조기 리턴을 활용해서 줄일 수 없는지 검토한다. | 가독성을 높일 수 있다.                            |
| 같은 조건 분기가 여러 개 구현되면, 인터페이스 설계를 검토한다.                                        | 수정 누락의 가능성이 높아진다.                        |
| 클래스와 메서드의 이름은 목적을 표현하는 형태로 작성한다.                                             | 목적을 모르면 로직이 난잡해질 수 있고, 유지 보수와 변경이 힘들어진다. |
이러한 규칙을 기반으로 다음과 같은 내용도 생각해 봐야 합니다.

- 설계 규칙은 성능이나 프레임워크의 제약 등 다양한 요건과 트레이드오프될 가능성이 있다.
- 규칙을 무조건 지켜야 하는 것은 아니며, 타협점을 찾아야 하는 상황도 분명히 존재한다.

팀의 설계 역량이 성숙하지 않으면 개인에게만 맡기지 말고, 설계를 어느 정도 아는 팀원이 설계 리뷰와 코드 리뷰를 하도록 해서, 설계 품질을 관리할 수 있게 합니다.


---

## 구현

#### 1) 깨진 유리창 이론과 보이스카우트 규칙

깨진 유리창 법칙은 소프트웨어 개발에도 적용됩니다. 조악하고 복잡하고 질서 없는 코드가 방치되면, 소프트웨어 전체가 점점 더 무질서해집니다. 저 코드를 보니까, 내 코드 정도는 그렇게 나쁜 편도 아니다 라는 마음의 틈이 생겨납니다. 이런 코드가 계속 쌓여 돌이킬 수 없는 수준까지 가면, 소프트웨어 전체의 코드가 부패되어 버립니다.

미국의 보이스카우트에는 '캠핑장을 자신이 왔을 때보다 더 깨끗하게 치우고 가기'라는 규칙이 있습니다. 이를 프로그래밍에도 적용해서 생각해 볼 수 있습니다. 코드를 변경할 때, 자신이 변경하기 전보다 더 깨끗한 상태로 만들어 커밋하는 것입니다.

#### 2) 기존의 코드를 믿지 말고, 냉정하게 파악하기

많은 사람이 조악한 코드를 보고도, 특별한 의심 없이 따라 하는 경우가 많습니다. 레거시 코드를 박멸하려면, 기존의 코드를 맹신하지 않는 마음가짐이 중요합니다. 구조적으로 이상한 것, 클래스 이름과 메서드 이름이 이상한 것 등 다양한 문제를 찾아보세요. 사양과 다른 이름을 갖고 있거나, 사양과 비슷하면서 다른 의미의 이름이 붙어 있지는 않은지 확인해 보세요.

#### 3) 코딩 규칙 사용하기

코드 작성 방식에 통일성이 없다면, 코드를 읽기가 매우 힘들어집니다. 코드를 읽기 쉽게 하려면, 코딩 규칙을 잘 지키는 것이 좋습니다. 코딩 규칙이란 코드의 가독성과 유지 보수성 향상, 문제가 있는 코드를 미연에 방지하기 위한 목적 등으로 코딩 스타일과 명명 규칙 등을 정해 놓은 것입니다.

코딩 규칙을 잘 준수하면, 코드의 구조와 이름에 질서가 생기고, 읽기 쉬워집니다.

#### 4) 명명 규칙

같은 프로그래밍 언어라도, 채택한 코딩 규칙에 따라서 명명 규칙이 조금씩 다를 수 있습니다. 또한 코딩 규칙은 기존의 것을 그대로 사용하기도 하고, 일부 개량해서 사용하기도 합니다. 

> 중요한 점은 팀 전체에서 통일된 규칙을 정하고, 이를 활용해서 가독성을 높이는 것입니다.


---

## 리뷰

#### 1) 코드 리뷰 구조화하기

레거시 코드가 작성되는 현장이라면, 코드 리뷰를 하는 습관 자체가 없는 경우가 많습니다. 어떻게든 동작하도록 작성된 난잡한 코드가 누구의 확인도 받지 않고 병합됩니다.

이러한 코드는 결국 품질이 떨어져, 버그가 빈번하게 발생합니다. 풀 리퀘스트한 코드는 '코드의 히스토리와 경위를 알고 있는 사람' 또는 '설계를 자세하게 알고 있는 사람'이 리뷰하는 것이 좋습니다.

#### 2) 코드를 설계 시점에 리뷰하기

많은 사람이 코드 리뷰를 '로직이 기능 요건을 만족하는지, 결함이 존재하는지, 코딩 스타일을 지키고 있는지 리뷰하는 것'이라고 생각합니다. 하지만 이보다는 설계적 타당성을 중심으로 리뷰해야 합니다.

#### 3) 존중과 예의

코드 리뷰 시 '기술적 올바름'을 두고, 공격적인 코멘트를 다는 사람이 있습니다. 하지만 아무리 옳은 말이라고 해도, 공격적 코멘트를 허용해서는 안 됩니다.

코드 리뷰에서 가장 중요한 것은 존중과 예의입니다. 리뷰를 받는 사람에 대한 존중을 먼저 생각하기 바랍니다. 기술적 올바름과 유용성보다도 함께 일하는 동료를 존중하는 것이 먼저입니다. 존중과 예의를 갖추고 지적하는 것이 코드 품질을 높이는 가장 빠른 길입니다.

상대방에게 상처를 줄 수 있는 표현을 쓰지 않도록 주의하세요. 옳다고 해서 어떤 표현을 사용하든 상관없다고 생각하는 것은 유치한 사고 방식입니다.

#### 4) 정기적으로 개선 작업 진행하기

구현 또는 코드 리뷰 중간에 좋지 않은 코드를 발견했는데, 스케줄 문제로 대처하지 못하는 경우가 있을 수 있습니다. 이때 일반적으로 '나중에 고치자'하고 넘어가곤 합니다.

하지만 이렇게 넘어간 결함은 대부분 특별한 대책 없이 방치됩니다. 왜냐하면 새로운 업무가 계속해서 할당되기 때문에, 새로운 업무에 정신이 팔려서 잊어버리기 때문입니다.

좋지 않은 코드에 대처하는 일은 작업 관리 도구에 개선 작업으로 추가해 두기 바랍니다.


---

## 팀의 설계 능력 높이기

이 장에서 지금까지 다룬 개발 프로세스는 설계 역량이 뛰어난 팀원이 어느 정도 있을 때의 이야기였습니다. 그런데 팀에 따라서는 설계를 잘 아는 팀원이 아예 없을 수도 있습니다. 팀 전체의 설계 능력이 부족하면, 설계 능력을 높이기 위한 활동이 필요합니다.

#### 1) 영향력을 갖는 규모까지 동료 모으기

혼자 힘으로는 품질을 높이려고 시도해도 효과가 거의 나지 않습니다. 오히려 남들은 '지시한 대로 일하지 않고, 쓸데없이 다른 일을 한다'라고 생각할 수도 있습니다.

설계뿐만 아니라 일의 방식을 상향식으로 개선하려면, 주위의 협력이 반드시 필요합니다. 그런데 왜 협력이 필요할까요? 서로 협력해야 일하는 방식을 바꿀 만큼 큰 영향력이 생기기 때문입니다.

#### 2) 천리길도 한 걸음부터

동료를 발견하면, 곧바로 이 책에 있는 내용들을 한꺼번에 전달하고 싶은 충동이 생길 수도 있습니다. 하지만 조급하게 굴면 안 됩니다. 사람은 한 번에 대량의 정보를 받아들일수 없으며, 큰 변화에 대해 불안과 저항을 느낍니다.

#### 3) 백문이 불여일견

동료와 설계 지식을 어느 정도 공유했다면, 함께 클래스를 설계하고 구현한 뒤 리뷰해 보세요. 즉, 개선 전과 후를 비교해 보면 가독성이 좋아졌음을 실감할 수 있습니다.

#### 4) 팔로우업 스터디 진행하기

동료를 더 모으려면 설계 스터디를 진행해 보는 것도 좋습니다. 저자가 추천하는 스터디 흐름입니다.

1. 책에 적혀 있는 노하우를 1~2개 정도 읽어 봅니다.
2. 프로덕션 코드에서 노하우를 적용해 볼 수 있는 부분을 찾습니다. 직접 다루던 코드면 더욱 좋습니다.
3. 노하우를 사용해 코드를 개선해 봅니다.
4. 어떻게 개선했는지 비포&애프터를 비교할 수 있게 발표합니다.
5. 발표 내용에 대해 질의 응답과 논의를 합니다.

#### 5) 스터디 그룹에서 발생할 수 있는 문제 해결 노하우

일단 단순하게 책을 읽기만 하는 스터디는 추천하지 않습니다. 아웃풋이 동반되지 않으므로 학습 효과가 낮습니다.
'이것이 올바른 설계 방법이니 무조건 이렇게 해야 합니다!' 라고 강요하는 것도 좋지 않습니다. 상대방의 의견에 공감하고, 상대방을 존중하는 자세가 필요합니다.
스터디에서도 설계 관련 기술을 무리하게 전달하려 하지 말고, 차근차근 전달해야 합니다. 변경 용이성이라는 품질 특성이 있고, 변경 용이성을 높일 수 있는 기술이 있음을 알리는 정도로 차근차근 시작하는 것이 좋습니다.

#### 6) 리더와 매니저에게 설계의 중요성과 비용 대비 효과 설명하기

조직 차원에서 설계 품질을 향상시키려면, 개발 프로세스 흐름에 설계를 추가해야 합니다. 매니저에게는 비용 대비 효과를 중심으로 이야기를 합시다. 매니저는 팀에 할당된 예산을 투자해 이익을 극대화해야 하는 책임이 있기 때문입니다. 따라서 매니저에게 있어서 최대의 관심사는 바로 비용 대비 효과입니다.

#### 7) 설계 책임자 세우기

설계 책임자는 변경 용이성 품질 향상을 위해, 다음과 같은 내용을 추진합니다.

- 설계 품질과 관련된 규칙이나 개발 프로세스 수립
- 규칙을 반복적으로 알리고 교육
- 리더와 매니저에거 효과 공유
- 품질 시각화
- 설계 품질 유지

설계 규칙, 코딩 규칙, 리뷰 방법 등 설계 품질과 관련된 규칙과 개발 프로세스를 수립하도록 합니다.